<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lab Computer Checklist Tracker</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 12px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 32px;
            margin-bottom: 10px;
        }

        .header p {
            opacity: 0.9;
            font-size: 16px;
        }

        .content {
            padding: 30px;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 10px;
            text-align: center;
        }

        .stat-number {
            font-size: 48px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .stat-label {
            font-size: 16px;
            opacity: 0.9;
        }

        .controls {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 30px;
        }

        .control-row {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .control-row:last-child {
            margin-bottom: 0;
        }

        input[type="text"], textarea {
            flex: 1;
            min-width: 200px;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            font-family: inherit;
        }

        textarea {
            min-height: 80px;
            resize: vertical;
        }

        input[type="file"] {
            display: none;
        }

        select {
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
            background: white;
            cursor: pointer;
        }

        button {
            padding: 12px 24px;
            border: none;
            border-radius: 6px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s;
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .btn-success {
            background: #28a745;
            color: white;
        }

        .btn-success:hover {
            background: #218838;
        }

        .btn-warning {
            background: #ffc107;
            color: #000;
        }

        .btn-warning:hover {
            background: #e0a800;
        }

        .btn-danger {
            background: #dc3545;
            color: white;
        }

        .btn-danger:hover {
            background: #c82333;
        }

        .btn-info {
            background: #17a2b8;
            color: white;
        }

        .btn-info:hover {
            background: #138496;
        }

        .bulk-actions {
            background: #e7f3ff;
            border: 2px solid #17a2b8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: none;
        }

        .bulk-actions.active {
            display: block;
        }

        .bulk-actions-buttons {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .computers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
            gap: 20px;
        }

        .computer-card {
            border: 2px solid #ddd;
            border-radius: 10px;
            padding: 20px;
            cursor: pointer;
            transition: all 0.3s;
            background: white;
            position: relative;
        }

        .computer-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        }

        .computer-card.selected {
            border-color: #17a2b8;
            box-shadow: 0 0 0 3px rgba(23, 162, 184, 0.2);
        }

        .computer-card.completed {
            background: linear-gradient(135deg, #11998e 0%, #38ef7d 100%);
            color: white;
            border-color: #11998e;
        }

        .computer-card.completed.selected {
            border-color: #17a2b8;
            box-shadow: 0 0 0 3px rgba(23, 162, 184, 0.4);
        }

        .card-checkbox {
            position: absolute;
            top: 10px;
            left: 10px;
            width: 24px;
            height: 24px;
            cursor: pointer;
            z-index: 10;
        }

        .computer-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            margin-top: 15px;
        }

        .computer-icon {
            font-size: 32px;
        }

        .computer-name {
            font-size: 20px;
            font-weight: bold;
            margin-bottom: 10px;
        }

        .computer-type {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-bottom: 15px;
        }

        .type-prod {
            background: #ffc107;
            color: #000;
        }

        .type-dev {
            background: #17a2b8;
            color: white;
        }

        .computer-card.completed .computer-type {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .progress-info {
            font-size: 14px;
            margin-bottom: 10px;
            font-weight: 600;
        }

        .progress-bar {
            height: 8px;
            background: #e9ecef;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #667eea 0%, #764ba2 100%);
            transition: width 0.3s;
        }

        .computer-card.completed .progress-bar {
            background: rgba(255,255,255,0.3);
        }

        .computer-card.completed .progress-fill {
            background: white;
        }

        .status-badge {
            display: inline-block;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
        }

        .status-complete {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        .status-incomplete {
            background: #ffc107;
            color: #000;
        }

        .computer-notes-preview {
            font-size: 12px;
            font-style: italic;
            color: #666;
            margin-top: 10px;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .computer-card.completed .computer-notes-preview {
            color: rgba(255,255,255,0.8);
        }

        .detail-view {
            display: none;
        }

        .detail-view.active {
            display: block;
        }

        .detail-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
            padding-bottom: 20px;
            border-bottom: 2px solid #e9ecef;
        }

        .detail-title {
            font-size: 28px;
            font-weight: bold;
        }

        .detail-progress {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
        }

        .computer-notes-section {
            background: #fff9e6;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
        }

        .computer-notes-section h3 {
            margin-bottom: 10px;
            color: #856404;
        }

        .computer-notes-section textarea {
            width: 100%;
            border: 1px solid #ddd;
        }

        .checklist {
            list-style: none;
        }

        .checklist-item {
            background: white;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            cursor: pointer;
            transition: all 0.2s;
        }

        .checklist-item:hover {
            border-color: #667eea;
            background: #f8f9ff;
        }

        .checklist-item.checked {
            background: #d4edda;
            border-color: #28a745;
        }

        .checklist-item input[type="checkbox"] {
            width: 20px;
            height: 20px;
            margin-right: 15px;
            cursor: pointer;
        }

        .checklist-item label {
            cursor: pointer;
            flex: 1;
            font-size: 15px;
        }

        .settings-view {
            display: none;
        }

        .settings-view.active {
            display: block;
        }

        .settings-list {
            list-style: none;
        }

        .settings-item {
            background: white;
            border: 2px solid #e9ecef;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .settings-item input {
            flex: 1;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }

        .settings-item button {
            padding: 8px 16px;
        }

        .warning {
            background: #fff3cd;
            border: 2px solid #ffc107;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: #856404;
        }

        .info-box {
            background: #e7f3ff;
            border: 2px solid #17a2b8;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: #004085;
        }

        .success-message {
            background: #d4edda;
            border: 2px solid #28a745;
            padding: 15px;
            border-radius: 8px;
            margin-bottom: 20px;
            color: #155724;
            display: none;
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>🖥️ Lab Computer Checklist Tracker</h1>
            <p>Track computer checkups and maintenance tasks</p>
        </div>

        <div class="content">
            <!-- Dashboard View -->
            <div id="dashboardView">
                <div class="stats-grid">
                    <div class="stat-card">
                        <div class="stat-number" id="totalComputers">0</div>
                        <div class="stat-label">Total Computers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="completedComputers">0</div>
                        <div class="stat-label">Completed Computers</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-number" id="pendingComputers">0</div>
                        <div class="stat-label">Pending Computers</div>
                    </div>
                </div>

                <div class="controls">
                    <div class="control-row">
                        <input type="text" id="computerName" placeholder="Enter computer name...">
                        <select id="computerType">
                            <option value="Production">Production</option>
                            <option value="Development">Development</option>
                        </select>
                        <button class="btn-primary" onclick="addComputer()">Add Computer</button>
                    </div>
                    <div class="control-row">
                        <button class="btn-secondary" onclick="showSettings()">⚙️ Settings</button>
                        <button class="btn-success" onclick="exportToCSV()">📥 Export CSV</button>
                        <button class="btn-success" onclick="document.getElementById('importFile').click()">📤 Import CSV</button>
                        <input type="file" id="importFile" accept=".csv" onchange="importFromCSV(event)">
                    </div>
                    <div class="control-row">
                        <button class="btn-info" onclick="toggleBulkMode()">☑️ Bulk Select</button>
                        <button class="btn-warning" onclick="resetAllChecks()">🔄 Reset All Checks</button>
                        <button class="btn-danger" onclick="clearAllData()">🗑️ Clear All Data</button>
                    </div>
                </div>

                <div id="bulkActions" class="bulk-actions">
                    <div style="margin-bottom: 10px;">
                        <strong><span id="selectedCount">0</span> computer(s) selected</strong>
                    </div>
                    <div class="bulk-actions-buttons">
                        <button class="btn-info" onclick="selectAll()">Select All</button>
                        <button class="btn-secondary" onclick="deselectAll()">Deselect All</button>
                        <button class="btn-success" onclick="bulkExport()">📥 Export Selected</button>
                        <button class="btn-danger" onclick="bulkDelete()">🗑️ Delete Selected</button>
                        <button class="btn-secondary" onclick="toggleBulkMode()">Cancel</button>
                    </div>
                </div>

                <div id="successMessage" class="success-message"></div>

                <div class="computers-grid" id="computersGrid"></div>
            </div>

            <!-- Detail View -->
            <div id="detailView" class="detail-view">
                <div class="detail-header">
                    <div>
                        <div class="detail-title" id="detailComputerName"></div>
                        <span class="computer-type" id="detailComputerType"></span>
                    </div>
                    <div style="display: flex; gap: 10px;">
                        <button class="btn-secondary" onclick="showDashboard()">← Back</button>
                        <button class="btn-danger" onclick="deleteCurrentComputer()">Delete Computer</button>
                    </div>
                </div>

                <div class="computer-notes-section">
                    <h3>📝 Computer Notes</h3>
                    <textarea id="computerNotesInput" placeholder="Add notes about this computer (e.g., special configurations, issues, hardware specs...)"></textarea>
                    <button class="btn-primary" onclick="saveComputerNotes()" style="margin-top: 10px;">Save Notes</button>
                </div>

                <div class="detail-progress">
                    <div class="progress-info" id="detailProgress"></div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="detailProgressFill"></div>
                    </div>
                </div>

                <ul class="checklist" id="detailChecklist"></ul>
            </div>

            <!-- Settings View -->
            <div id="settingsView" class="settings-view">
                <div class="detail-header">
                    <div class="detail-title">Checklist Settings</div>
                    <button class="btn-secondary" onclick="showDashboard()">← Back</button>
                </div>

                <div class="warning">
                    <strong>⚠️ Warning:</strong> Changes to the checklist only affect NEW computers. Existing computers will keep their current tasks.
                </div>

                <ul class="settings-list" id="settingsList"></ul>

                <div class="control-row" style="margin-top: 20px;">
                    <input type="text" id="newTaskInput" placeholder="Enter new task...">
                    <button class="btn-primary" onclick="addNewTask()">Add Task</button>
                    <button class="btn-danger" onclick="resetToDefault()">Reset to Default</button>
                </div>
            </div>
        </div>
    </div>

    <script>
        const DEFAULT_CHECKLIST = [
            "Check for bitlocker encription (manage-bde -status)",
            "Check SCCM PC Admin for windows site",
            "Check SCCM PC Admin for missing package",
            "Check number of app installed",
            "Check for Windows Updates",
            "Add user to remote desktop settings",
            "Remove user from 95 is it's a DEV",
        ];

        let computers = [];
        let checklist = [...DEFAULT_CHECKLIST];
        let currentComputerId = null;
        let bulkMode = false;
        let selectedComputers = new Set();

        function loadData() {
            try {
                const savedComputers = localStorage.getItem('labComputers');
                const savedChecklist = localStorage.getItem('labChecklist');
                
                if (savedComputers) {
                    const parsed = JSON.parse(savedComputers);
                    computers = Array.isArray(parsed) ? parsed : [];
                    computers = computers.map(c => ({
                        ...c,
                        notes: c.notes || ''
                    }));
                } else {
                    computers = [];
                }
                
                if (savedChecklist) {
                    const parsed = JSON.parse(savedChecklist);
                    checklist = Array.isArray(parsed) ? parsed : [...DEFAULT_CHECKLIST];
                } else {
                    checklist = [...DEFAULT_CHECKLIST];
                }
            } catch (e) {
                console.error('Error loading data:', e);
                computers = [];
                checklist = [...DEFAULT_CHECKLIST];
            }
        }

        function saveData() {
            try {
                localStorage.setItem('labComputers', JSON.stringify(computers));
                localStorage.setItem('labChecklist', JSON.stringify(checklist));
            } catch (e) {
                console.error('Error saving data:', e);
                alert('Error saving data. Please try again.');
            }
        }

        function showSuccess(message) {
            const msgEl = document.getElementById('successMessage');
            msgEl.textContent = message;
            msgEl.style.display = 'block';
            setTimeout(() => {
                msgEl.style.display = 'none';
            }, 3000);
        }

        function addComputer() {
            const nameInput = document.getElementById('computerName');
            const typeSelect = document.getElementById('computerType');
            const name = nameInput.value.trim();
            
            if (!name) {
                alert('Please enter a computer name');
                return;
            }

            const computer = {
                id: Date.now(),
                name: name,
                type: typeSelect.value,
                notes: '',
                tasks: checklist.map((task, index) => ({
                    id: index,
                    text: task,
                    completed: false
                }))
            };

            computers.push(computer);
            saveData();
            nameInput.value = '';
            renderDashboard();
            showSuccess(`Computer "${name}" added successfully!`);
        }

        function toggleBulkMode() {
            bulkMode = !bulkMode;
            selectedComputers.clear();
            document.getElementById('bulkActions').classList.toggle('active', bulkMode);
            renderDashboard();
        }

        function toggleComputerSelection(id, event) {
            event.stopPropagation();
            if (selectedComputers.has(id)) {
                selectedComputers.delete(id);
            } else {
                selectedComputers.add(id);
            }
            document.getElementById('selectedCount').textContent = selectedComputers.size;
            renderDashboard();
        }

        function selectAll() {
            computers.forEach(c => selectedComputers.add(c.id));
            document.getElementById('selectedCount').textContent = selectedComputers.size;
            renderDashboard();
        }

        function deselectAll() {
            selectedComputers.clear();
            document.getElementById('selectedCount').textContent = 0;
            renderDashboard();
        }

        function bulkDelete() {
            if (selectedComputers.size === 0) {
                alert('No computers selected');
                return;
            }
            if (confirm(`Delete ${selectedComputers.size} selected computer(s)?`)) {
                computers = computers.filter(c => !selectedComputers.has(c.id));
                selectedComputers.clear();
                saveData();
                toggleBulkMode();
                renderDashboard();
                showSuccess('Selected computers deleted!');
            }
        }

        function bulkExport() {
            if (selectedComputers.size === 0) {
                alert('No computers selected');
                return;
            }

            const selected = computers.filter(c => selectedComputers.has(c.id));
            let csv = 'Computer Name,Type,Notes,Task,Completed\n';
            
            selected.forEach(computer => {
                computer.tasks.forEach(task => {
                    const row = [
                        `"${computer.name}"`,
                        `"${computer.type}"`,
                        `"${(computer.notes || '').replace(/"/g, '""')}"`,
                        `"${task.text}"`,
                        task.completed ? 'Yes' : 'No'
                    ].join(',');
                    csv += row + '\n';
                });
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `lab-computers-selected-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showSuccess(`Exported ${selectedComputers.size} computers!`);
        }

        function deleteComputer(id) {
            const computer = computers.find(c => c.id === id);
            if (computer && confirm(`Are you sure you want to delete "${computer.name}"?`)) {
                computers = computers.filter(c => c.id !== id);
                saveData();
                renderDashboard();
                showSuccess(`Computer "${computer.name}" deleted successfully!`);
            }
        }

        function deleteCurrentComputer() {
            if (currentComputerId) {
                const computer = computers.find(c => c.id === currentComputerId);
                if (computer && confirm(`Are you sure you want to delete "${computer.name}"?`)) {
                    computers = computers.filter(c => c.id !== currentComputerId);
                    saveData();
                    showDashboard();
                    showSuccess(`Computer "${computer.name}" deleted successfully!`);
                }
            }
        }

        function clearAllData() {
            if (confirm('This will delete ALL computers AND reset the checklist to default. Are you sure?')) {
                computers = [];
                checklist = [...DEFAULT_CHECKLIST];
                localStorage.clear();
                saveData();
                renderDashboard();
                showSuccess('All data cleared! Starting fresh.');
            }
        }

        function resetAllChecks() {
            if (computers.length === 0) {
                alert('No computers to reset');
                return;
            }
            if (confirm('Reset all task checks for all computers?')) {
                computers.forEach(computer => {
                    computer.tasks.forEach(task => {
                        task.completed = false;
                    });
                });
                saveData();
                renderDashboard();
                showSuccess('All checks reset successfully!');
            }
        }

        function exportToCSV() {
            if (computers.length === 0) {
                alert('No data to export');
                return;
            }

            let csv = 'Computer Name,Type,Notes,Task,Completed\n';
            
            computers.forEach(computer => {
                computer.tasks.forEach(task => {
                    const row = [
                        `"${computer.name}"`,
                        `"${computer.type}"`,
                        `"${(computer.notes || '').replace(/"/g, '""')}"`,
                        `"${task.text}"`,
                        task.completed ? 'Yes' : 'No'
                    ].join(',');
                    csv += row + '\n';
                });
            });

            const blob = new Blob([csv], { type: 'text/csv' });
            const url = window.URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `lab-computers-${new Date().toISOString().split('T')[0]}.csv`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            window.URL.revokeObjectURL(url);
            
            showSuccess('Data exported successfully!');
        }

        function importFromCSV(event) {
            const file = event.target.files[0];
            if (!file) return;

            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const text = e.target.result;
                    const lines = text.split('\n').filter(line => line.trim());
                    
                    if (lines.length < 2) {
                        alert('Invalid CSV file');
                        return;
                    }

                    const dataLines = lines.slice(1);
                    const importedComputers = {};

                    dataLines.forEach(line => {
                        const match = line.match(/^"([^"]*)","([^"]*)","([^"]*)","([^"]*)","?([^"]*)"?$/);
                        if (!match) return;

                        const [, name, type, compNotes, taskText, completed] = match;
                        
                        if (!importedComputers[name]) {
                            importedComputers[name] = {
                                id: Date.now() + Math.random(),
                                name: name,
                                type: type,
                                notes: compNotes || '',
                                tasks: []
                            };
                        }

                        importedComputers[name].tasks.push({
                            id: importedComputers[name].tasks.length,
                            text: taskText,
                            completed: completed.toLowerCase() === 'yes'
                        });
                    });

                    if (Object.keys(importedComputers).length === 0) {
                        alert('No valid data found in CSV');
                        return;
                    }

                    if (confirm(`Import ${Object.keys(importedComputers).length} computers? This will REPLACE all current data.`)) {
                        computers = Object.values(importedComputers);
                        saveData();
                        renderDashboard();
                        showSuccess(`Successfully imported ${computers.length} computers!`);
                    }
                } catch (error) {
                    console.error('Import error:', error);
                    alert('Error importing CSV file. Please check the format.');
                }
            };
            reader.readAsText(file);
            event.target.value = '';
        }

        function saveComputerNotes() {
            if (!currentComputerId) return;
            
            const computer = computers.find(c => c.id === currentComputerId);
            if (computer) {
                const notesInput = document.getElementById('computerNotesInput');
                computer.notes = notesInput.value.trim();
                saveData();
                showSuccess('Notes saved!');
                renderDashboard();
            }
        }

        function toggleTask(computerId, taskId) {
            const computer = computers.find(c => c.id === computerId);
            if (computer) {
                const task = computer.tasks.find(t => t.id === taskId);
                if (task) {
                    task.completed = !task.completed;
                    saveData();
                    renderDetailView(computerId);
                    renderDashboard();
                }
            }
        }

        function calculateProgress(computer) {
            const completed = computer.tasks.filter(t => t.completed).length;
            const total = computer.tasks.length;
            return { completed, total, percentage: (completed / total) * 100 };
        }

        function renderDashboard() {
            const grid = document.getElementById('computersGrid');
            grid.innerHTML = '';

            if (computers.length === 0) {
                grid.innerHTML = '<p style="grid-column: 1/-1; text-align: center; padding: 40px; color: #6c757d;">No computers added yet. Add one to get started!</p>';
            }

            computers.forEach(computer => {
                const progress = calculateProgress(computer);
                const isComplete = progress.completed === progress.total;
                const isSelected = selectedComputers.has(computer.id);

                const card = document.createElement('div');
                card.className = `computer-card ${isComplete ? 'completed' : ''} ${isSelected ? 'selected' : ''}`;
                
                const cardContent = `
                    ${bulkMode ? `<input type="checkbox" class="card-checkbox" ${isSelected ? 'checked' : ''} onclick="toggleComputerSelection(${computer.id}, event)">` : ''}
                    <div class="computer-header">
                        <div class="computer-icon">${isComplete ? '✅' : '🖥️'}</div>
                    </div>
                    <div class="computer-name">${computer.name}</div>
                    <span class="computer-type ${computer.type === 'Production' ? 'type-prod' : 'type-dev'}">
                        ${computer.type}
                    </span>
                    <div class="progress-info">${progress.completed}/${progress.total} tasks</div>
                    <div class="progress-bar">
                        <div class="progress-fill" style="width: ${progress.percentage}%"></div>
                    </div>
                    <span class="status-badge ${isComplete ? 'status-complete' : 'status-incomplete'}">
                        ${isComplete ? 'Complete' : 'In Progress'}
                    </span>
                    ${computer.notes ? `<div class="computer-notes-preview">📝 ${computer.notes}</div>` : ''}
                `;
                
                card.innerHTML = cardContent;
                
                if (!bulkMode) {
                    card.onclick = () => showDetailView(computer.id);
                }
                
                grid.appendChild(card);
            });

            updateStats();
        }

        function updateStats() {
            const total = computers.length;
            const completed = computers.filter(c => {
                const progress = calculateProgress(c);
                return progress.completed === progress.total;
            }).length;
            const pending = total - completed;

            document.getElementById('totalComputers').textContent = total;
            document.getElementById('completedComputers').textContent = completed;
            document.getElementById('pendingComputers').textContent = pending;
        }

        function showDetailView(computerId) {
            currentComputerId = computerId;
            document.getElementById('dashboardView').classList.remove('active');
            document.getElementById('dashboardView').style.display = 'none';
            document.getElementById('detailView').classList.add('active');
            document.getElementById('settingsView').classList.remove('active');
            renderDetailView(computerId);
        }

        function renderDetailView(computerId) {
            const computer = computers.find(c => c.id === computerId);
            if (!computer) return;

            const progress = calculateProgress(computer);

            document.getElementById('detailComputerName').textContent = computer.name;
            const typeSpan = document.getElementById('detailComputerType');
            typeSpan.textContent = computer.type;
            typeSpan.className = `computer-type ${computer.type === 'Production' ? 'type-prod' : 'type-dev'}`;

            document.getElementById('computerNotesInput').value = computer.notes || '';

            document.getElementById('detailProgress').textContent = 
                `${progress.completed} of ${progress.total} tasks completed`;
            document.getElementById('detailProgressFill').style.width = `${progress.percentage}%`;

            const checklistEl = document.getElementById('detailChecklist');
            checklistEl.innerHTML = '';

            computer.tasks.forEach(task => {
                const li = document.createElement('li');
                li.className = `checklist-item ${task.completed ? 'checked' : ''}`;
                li.onclick = () => toggleTask(computerId, task.id);

                li.innerHTML = `
                    <input type="checkbox" ${task.completed ? 'checked' : ''} onclick="event.stopPropagation(); toggleTask(${computerId}, ${task.id})">
                    <label>${task.text}</label>
                `;

                checklistEl.appendChild(li);
            });
        }

        function showDashboard() {
            currentComputerId = null;
            bulkMode = false;
            selectedComputers.clear();
            document.getElementById('bulkActions').classList.remove('active');
            document.getElementById('dashboardView').style.display = 'block';
            document.getElementById('dashboardView').classList.add('active');
            document.getElementById('detailView').classList.remove('active');
            document.getElementById('settingsView').classList.remove('active');
            renderDashboard();
        }

        function showSettings() {
            document.getElementById('dashboardView').style.display = 'none';
            document.getElementById('dashboardView').classList.remove('active');
            document.getElementById('detailView').classList.remove('active');
            document.getElementById('settingsView').classList.add('active');
            renderSettings();
        }

        function renderSettings() {
            const list = document.getElementById('settingsList');
            list.innerHTML = '';

            checklist.forEach((task, index) => {
                const li = document.createElement('li');
                li.className = 'settings-item';

                li.innerHTML = `
                    <input type="text" value="${task}" onchange="updateTask(${index}, this.value)">
                    <button class="btn-danger" onclick="deleteTask(${index})">Delete</button>
                `;

                list.appendChild(li);
            });
        }

        function updateTask(index, newText) {
            if (newText.trim()) {
                checklist[index] = newText.trim();
                saveData();
            }
        }

        function deleteTask(index) {
            if (confirm('Delete this task from the checklist?')) {
                checklist.splice(index, 1);
                saveData();
                renderSettings();
            }
        }

        function addNewTask() {
            const input = document.getElementById('newTaskInput');
            const text = input.value.trim();

            if (!text) {
                alert('Please enter a task');
                return;
            }

            checklist.push(text);
            saveData();
            input.value = '';
            renderSettings();
        }

        function resetToDefault() {
            if (confirm('Reset checklist to default? This will not affect existing computers.')) {
                checklist = [...DEFAULT_CHECKLIST];
                saveData();
                renderSettings();
            }
        }

        loadData();
        renderDashboard();
    </script>
</body>
</html>
